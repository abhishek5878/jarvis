{% extends "content_base.html" %}

{% block title %}Refer Friends{% endblock %}

{% block content %}
<div class="max-w-4xl mx-auto">
    <div class="text-center mb-8">
        <h1 class="text-3xl font-bold text-gray-900 mb-2">ğŸ Refer Friends, Get Free Generations</h1>
        <p class="text-gray-600">Give 15 generations, get 5. Everyone wins.</p>
    </div>
    
    <div class="bg-white rounded-2xl shadow-xl p-8 mb-8 border-2 border-gray-100">
        <h3 class="font-semibold text-gray-900 mb-4">Your Referral Link</h3>
        <div class="flex gap-2">
            <input type="text" id="referral-link" value="{{ referral_link }}" readonly
                   class="flex-1 px-4 py-3 bg-gray-50 border-2 border-gray-200 rounded-xl">
            <button onclick="copyLink()" class="px-6 py-3 bg-blue-600 text-white rounded-xl hover:bg-blue-700 font-medium transition">
                Copy
            </button>
        </div>
        <p class="text-sm text-gray-500 mt-2">Share this link with friends. When they sign up, you both get bonus generations!</p>
    </div>
    
    <div class="grid md:grid-cols-3 gap-6 mb-8">
        <div class="bg-white rounded-xl shadow-sm p-6 text-center">
            <div class="text-4xl font-bold text-blue-600">{{ stats.total }}</div>
            <div class="text-gray-600">Total Referrals</div>
        </div>
        <div class="bg-white rounded-xl shadow-sm p-6 text-center">
            <div class="text-4xl font-bold text-green-600">{{ stats.converted }}</div>
            <div class="text-gray-600">Active Users</div>
        </div>
        <div class="bg-white rounded-xl shadow-sm p-6 text-center">
            <div class="text-4xl font-bold text-purple-600">+{{ bonus_generations }}</div>
            <div class="text-gray-600">Bonus Generations</div>
        </div>
    </div>
    
    <div class="bg-gradient-to-r from-blue-50 to-purple-50 border-2 border-blue-200 rounded-xl p-6 mb-8">
        <h3 class="font-semibold text-gray-900 mb-4">ğŸ† Referral Rewards</h3>
        <div class="space-y-2 text-sm">
            <div class="flex justify-between"><span>5 referrals</span><span class="font-semibold text-blue-600">1 month Pro free</span></div>
            <div class="flex justify-between"><span>10 referrals</span><span class="font-semibold text-blue-600">3 months Pro free</span></div>
            <div class="flex justify-between"><span>25 referrals</span><span class="font-semibold text-blue-600">1 year Pro free</span></div>
            <div class="flex justify-between"><span>50 referrals</span><span class="font-semibold text-purple-600">Lifetime Pro!</span></div>
        </div>
    </div>
    
    {% if recent %}
    <div class="bg-white rounded-xl shadow-sm p-6">
        <h3 class="font-semibold text-gray-900 mb-4">Recent Referrals</h3>
        <div class="space-y-3">
            {% for ref in recent %}
            <div class="flex justify-between items-center text-sm">
                <div>
                    <span class="font-medium">{{ ref.username }}</span>
                    <span class="text-gray-500 ml-2">{{ ref.signup_date[:10] if ref.signup_date else '' }}</span>
                </div>
                <span class="{% if ref.converted %}text-green-600{% else %}text-gray-400{% endif %}">
                    {% if ref.converted %}âœ“ Active{% else %}Pending{% endif %}
                </span>
            </div>
            {% endfor %}
        </div>
    </div>
    {% endif %}
</div>

<script>
function copyLink() {
    const link = document.getElementById('referral-link');
    link.select();
    navigator.clipboard.writeText(link.value);
    if (event && event.target) {
        event.target.textContent = 'âœ“ Copied!';
        setTimeout(() => { event.target.textContent = 'Copy'; }, 2000);
    }
}
</script>
{% endblock %}
